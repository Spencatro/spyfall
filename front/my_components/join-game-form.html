<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/core-ajax/core-ajax.html">
<polymer-element name="join-game-form">
  <template>
    <h1>
        Join a game!
    </h1>
    <paper-input-decorator floatingLabel="True" label="Your name"><input value="{{nameValue}}" id="your-name" /></paper-input-decorator>
    <paper-input-decorator floatingLabel="True" label="Gameroom name"><input value="{{gameroomNameValue}}" id="gameroom-name" /></paper-input-decorator>
    <paper-input-decorator floatingLabel="True" label="Gameroom passcode (optional)"><input value="{{gameroomPasscodeValue}}" id="gameroom-passcode" /></paper-input-decorator>
    <paper-button on-click="{{clicked}}" disabled?="{{isDisabled}}" id="go-button" raised>{{innerContent}}</paper-button>
  </template>
  <script>
  Polymer({
    innerContent:"Let's gooooo!",
    isDisabled: false,
    clicked: function(e) {
      poly = this
      poly.isDisabled = true;
      poly.innerContent = "Searching for your game...";
      console.log(this.nameValue);
      thing = this;
      $.getJSON("http://spyfall-backend.spencer-hawkins.com/game_exists/"+this.gameroomNameValue+"/", function(result) {
        if (result.result == true) {
          poly.innerContent = "Game found! Joining...";
        } else if(result.passcode_error) {
          poly.innerContent = "Game not found... Try again?";
          poly.isDisabled = false;
        }
      });
    }
  });
  </script>
</polymer-element>